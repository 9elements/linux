// Definitions for NXP PCA9548A I2C mux on ARM I2C bus. Two muxes supported
/dts-v1/;
/plugin/;

/{
        compatible = "brcm,bcm2835", "brcm,bcm2836", "brcm,bcm2708", "brcm,bcm2709";

	fragment@0 {
		target = <&i2c_arm>;
		__overlay__ {
			#address-cells = <1>;
			#size-cells = <0>;
			status = "okay";

			i2cmux: mux@70 {
				compatible = "maxim,max7357";
				reg = <0x70>;
				#address-cells = <1>;
				#size-cells = <0>;

				i2c@0 {
					#address-cells = <1>;
					#size-cells = <0>;
					reg = <0>;
				};
				i2c@1 {
					#address-cells = <1>;
					#size-cells = <0>;
					reg = <1>;
				};
				i2c@2 {
					#address-cells = <1>;
					#size-cells = <0>;
					reg = <2>;
				};
				i2c@3 {
					#address-cells = <1>;
					#size-cells = <0>;
					reg = <3>;
				};
				i2c@4 {
					#address-cells = <1>;
					#size-cells = <0>;
					reg = <4>;
				};
				i2c@5 {
					#address-cells = <1>;
					#size-cells = <0>;
					reg = <5>;
				};
				i2c@6 {
					#address-cells = <1>;
					#size-cells = <0>;
					reg = <6>;
				};
				i2c@7 {
					#address-cells = <1>;
					#size-cells = <0>;
					reg = <7>;
					gpioexpander: gpo@20 {
						compatible = "cypress,cy8c9520";
						reg = <0x20>;
						gpio-controller;
						#gpio-cells = <2>;
						#interrupt-cells=<2>;
						interrupt-parent = <&gpio>;
						interrupts = <20 1>;
						interrupt-controller;
						status = "okay";
					};
				};
			};
		};
	};

	fragment@1 {
		target = <&gpio>;
		__overlay__ {
			gpioexpander_pins: gpioexpander_pins {
				brcm,pins = <20>;
				brcm,function = <0>;
				brcm,pull = <0>; /* none */
			};
		};
	};
	__overrides__ {
		gpiopin = <&gpioexpander_pins>,"brcm,pins:0",
				<&gpioexpander>,"interrupts:0";
		addr = <&i2cmux>,"reg:0",
			<&gpioexpander>, "reg:0";
	};
};
